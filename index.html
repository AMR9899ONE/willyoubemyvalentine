<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üíï For You</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=VT323&family=Press+Start+2P&family=Pacifico&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            position: fixed;
        }

        body {
            font-family: 'VT323', monospace;
            background: #1a0a0a;
            touch-action: pan-y;
            image-rendering: pixelated;
        }

        /* RETRO Scanlines Effect */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: repeating-linear-gradient(
                0deg,
                rgba(0, 0, 0, 0.15) 0px,
                rgba(0, 0, 0, 0.15) 1px,
                transparent 1px,
                transparent 2px
            );
            pointer-events: none;
            z-index: 9999;
            animation: scanline 8s linear infinite;
        }

        @keyframes scanline {
            0% { transform: translateY(0); }
            100% { transform: translateY(10px); }
        }

        /* RETRO CRT Curve Effect */
        .gradient-bg {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            background: 
                radial-gradient(ellipse at center, #2a0a0a 0%, #1a0a0a 50%, #0a0000 100%);
            animation: crtFlicker 0.3s infinite alternate;
        }

        @keyframes crtFlicker {
            0% { opacity: 0.97; }
            100% { opacity: 1; }
        }

        /* RETRO VHS Tracking Lines */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(255, 0, 0, 0.3), transparent);
            z-index: 9998;
            animation: vhsTracking 2s linear infinite;
        }

        @keyframes vhsTracking {
            0% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }

        /* Rose Petals - RETRO PIXELATED */
        .rose-petal {
            position: fixed;
            width: 15px;
            height: 15px;
            background: 
                linear-gradient(45deg, #ff0033 0%, #cc0000 50%, #990000 100%);
            clip-path: polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%);
            pointer-events: all;
            cursor: pointer;
            z-index: 5;
            opacity: 0;
            animation: petalFall linear infinite;
            box-shadow: 
                0 0 10px rgba(255, 0, 51, 0.6),
                inset -2px -2px 0 rgba(0, 0, 0, 0.3);
            transition: transform 0.1s steps(3), filter 0.1s;
            image-rendering: pixelated;
        }

        .rose-petal:hover {
            transform: scale(1.5);
            filter: brightness(1.5) drop-shadow(0 0 15px rgba(255, 0, 51, 1));
        }

        .rose-petal:active {
            transform: scale(1.2);
        }

        @keyframes petalFall {
            0% {
                transform: translateY(-100px) translateX(0) rotate(0deg) scale(1);
                opacity: 0;
            }
            10% {
                opacity: 0.9;
            }
            90% {
                opacity: 0.6;
            }
            100% {
                transform: translateY(100vh) translateX(var(--drift)) rotate(var(--rotation)) scale(0.3);
                opacity: 0;
            }
        }

        .rose-petal.spinning {
            animation: petalSpin linear infinite;
        }

        @keyframes petalSpin {
            0% {
                transform: translateY(-100px) translateX(0) rotate(0deg) scale(1);
                opacity: 0;
            }
            10% {
                opacity: 0.9;
            }
            50% {
                opacity: 0.8;
                transform: translateY(50vh) translateX(var(--drift)) rotate(720deg) scale(0.8);
            }
            90% {
                opacity: 0.5;
            }
            100% {
                transform: translateY(100vh) translateX(calc(var(--drift) * 1.5)) rotate(1080deg) scale(0.2);
                opacity: 0;
            }
        }

        /* RETRO Pixel Particles */
        .particle {
            position: fixed;
            width: 4px;
            height: 4px;
            background: #ff0033;
            box-shadow: 0 0 8px #ff0033;
            pointer-events: none;
            animation: particleFloat linear infinite;
            z-index: 1;
            image-rendering: pixelated;
        }

        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) translateX(0) scale(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
                transform: scale(1);
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-20vh) translateX(100px) scale(0);
                opacity: 0;
            }
        }

        /* Page container */
        .page {
            position: absolute;
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: clamp(20px, 5vw, 60px);
            opacity: 0;
            transform: scale(0.8);
            pointer-events: none;
            transition: all 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            z-index: 10;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        .page.active {
            opacity: 1;
            transform: scale(1);
            pointer-events: all;
        }

        .page.exiting {
            opacity: 0;
            transform: scale(1.2);
        }

        /* RETRO Polaroid */
        .polaroid {
            position: fixed;
            background: #f0e6d2;
            padding: clamp(10px, 1.5vw, 15px);
            padding-bottom: clamp(40px, 6vw, 60px);
            box-shadow: 
                0 8px 0 #d0c6b2,
                0 10px 25px rgba(0, 0, 0, 0.5);
            transform: rotate(var(--rotation));
            animation: polaroidFloat 12s ease-in-out infinite;
            z-index: 8;
            opacity: 0;
            transition: all 0.3s steps(5);
            cursor: pointer;
            border: 3px solid #c0b6a2;
            image-rendering: pixelated;
        }

        .polaroid.visible {
            opacity: 1;
        }

        .polaroid:hover {
            opacity: 1 !important;
            transform: rotate(0deg) scale(1.3);
            z-index: 100;
            box-shadow: 
                0 12px 0 #d0c6b2,
                0 15px 40px rgba(255, 0, 0, 0.6);
        }

        .polaroid img {
            width: clamp(120px, 15vw, 180px);
            height: clamp(120px, 15vw, 180px);
            object-fit: cover;
            display: block;
            background: #f0f0f0;
            border: 2px solid #999;
            filter: sepia(0.2) contrast(1.1);
        }

        .polaroid::after {
            content: attr(data-caption);
            position: absolute;
            bottom: clamp(12px, 2vw, 18px);
            left: clamp(10px, 1.5vw, 15px);
            right: clamp(10px, 1.5vw, 15px);
            text-align: center;
            font-family: 'Pacifico', cursive;
            font-size: clamp(11px, 1.2vw, 15px);
            color: #333;
        }

        @keyframes polaroidFloat {
            0%, 100% {
                transform: translateY(0) rotate(var(--rotation)) scale(1);
            }
            50% {
                transform: translateY(-20px) rotate(calc(var(--rotation) + 5deg)) scale(1.02);
            }
        }

        /* RETRO Typography */
        .title {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(1.2em, 5vw, 2.8em);
            color: #ff0033;
            text-shadow: 
                3px 3px 0 #990000,
                6px 6px 0 #660000,
                0 0 20px #ff0033,
                0 0 40px #ff0033;
            margin-bottom: clamp(20px, 4vh, 40px);
            text-align: center;
            line-height: 1.6;
            padding: 0 15px;
            animation: glitchTitle 3s infinite;
            letter-spacing: 2px;
        }

        @keyframes glitchTitle {
            0%, 90%, 100% { 
                transform: translate(0);
                text-shadow: 
                    3px 3px 0 #990000,
                    6px 6px 0 #660000,
                    0 0 20px #ff0033;
            }
            92% { 
                transform: translate(-2px, 2px);
                text-shadow: 
                    3px 3px 0 #00ff00,
                    6px 6px 0 #0000ff,
                    0 0 20px #ff0033;
            }
            94% { 
                transform: translate(2px, -2px);
                text-shadow: 
                    3px 3px 0 #0000ff,
                    6px 6px 0 #00ff00,
                    0 0 20px #ff0033;
            }
        }

        .subtitle {
            font-family: 'VT323', monospace;
            font-size: clamp(1.3em, 3.5vw, 2em);
            color: #ffaa00;
            text-shadow: 2px 2px 0 #995500, 0 0 10px #ffaa00;
            margin-bottom: clamp(20px, 4vh, 40px);
            text-align: center;
            padding: 0 15px;
            letter-spacing: 1px;
        }

        .text {
            font-family: 'VT323', monospace;
            font-size: clamp(1.3em, 3vw, 1.8em);
            color: #ffffff;
            text-shadow: 1px 1px 0 #ff0033, 0 0 5px rgba(255, 0, 51, 0.5);
            line-height: 1.6;
            max-width: min(90%, 600px);
            text-align: center;
            margin: clamp(10px, 2vh, 20px) 0;
            padding: 0 15px;
            letter-spacing: 1px;
        }

        .japanese {
            font-family: 'VT323', monospace;
            font-size: clamp(1.6em, 4.5vw, 2.5em);
            color: #ff0033;
            text-shadow: 
                2px 2px 0 #990000,
                0 0 15px #ff0033;
            margin: clamp(15px, 3vh, 25px) 0;
            text-align: center;
            padding: 0 15px;
            letter-spacing: 2px;
        }

        /* Tap instruction */
        .tap-anywhere {
            position: absolute;
            bottom: clamp(30px, 6vh, 60px);
            font-family: 'VT323', monospace;
            font-size: clamp(1.1em, 2.5vw, 1.5em);
            color: #ffaa00;
            text-shadow: 2px 2px 0 #995500, 0 0 10px #ffaa00;
            animation: blink 1.5s steps(2) infinite;
            padding: 0 20px;
            text-align: center;
            letter-spacing: 2px;
        }

        @keyframes blink {
            0%, 49% { opacity: 1; }
            50%, 100% { opacity: 0.3; }
        }

        /* RETRO Lily garden */
        .lily-container {
            display: flex;
            gap: clamp(20px, 4vw, 40px);
            flex-wrap: wrap;
            justify-content: center;
            margin: clamp(20px, 4vh, 50px) 0;
            max-width: 100%;
        }

        .lily {
            font-size: clamp(3em, 10vw, 5em);
            cursor: pointer;
            transition: all 0.2s steps(3);
            filter: 
                drop-shadow(0 0 10px rgba(255, 0, 51, 0.6))
                drop-shadow(5px 5px 0 rgba(0, 0, 0, 0.5));
            animation: lilyPulse 2s steps(4) infinite;
            user-select: none;
            image-rendering: pixelated;
        }

        .lily:hover,
        .lily:active {
            transform: scale(1.3) rotate(15deg);
            filter: 
                drop-shadow(0 0 20px rgba(255, 0, 51, 1))
                drop-shadow(8px 8px 0 rgba(0, 0, 0, 0.7));
        }

        .lily.clicked {
            animation: lilyExplode 0.6s steps(5) forwards;
            pointer-events: none;
        }

        @keyframes lilyPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes lilyExplode {
            0% { 
                transform: scale(1) rotate(0deg);
                opacity: 1;
            }
            50% { 
                transform: scale(2) rotate(180deg);
                filter: brightness(2) drop-shadow(0 0 30px #ff0033);
            }
            100% { 
                transform: scale(0) rotate(360deg);
                opacity: 0;
            }
        }

        /* RETRO Message box */
        .message-reveal {
            background: 
                linear-gradient(135deg, rgba(255, 0, 51, 0.1) 0%, rgba(153, 0, 0, 0.1) 100%);
            border: 4px solid #ff0033;
            box-shadow: 
                0 0 20px rgba(255, 0, 51, 0.5),
                inset 0 0 20px rgba(255, 0, 51, 0.1);
            padding: clamp(20px, 4vw, 35px);
            margin: clamp(15px, 3vh, 30px) 0;
            max-width: min(90%, 550px);
            animation: messageSlideIn 0.5s steps(8);
        }

        @keyframes messageSlideIn {
            from {
                opacity: 0;
                transform: translateY(50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message-reveal h3 {
            font-family: 'Press Start 2P', cursive;
            color: #ffaa00;
            font-size: clamp(1em, 3vw, 1.4em);
            text-shadow: 2px 2px 0 #995500, 0 0 10px #ffaa00;
            margin-bottom: clamp(15px, 3vh, 25px);
            text-align: center;
            line-height: 1.6;
        }

        /* RETRO Totoro */
        .totoro {
            font-family: 'VT323', monospace;
            font-size: clamp(14px, 2.5vw, 20px);
            line-height: 1.2;
            color: #ffaa00;
            text-shadow: 2px 2px 0 #995500, 0 0 10px #ffaa00;
            white-space: pre;
            text-align: center;
            animation: totoroBounce 2s steps(4) infinite;
        }

        @keyframes totoroBounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        /* RETRO Buttons */
        .btn {
            font-family: 'Press Start 2P', cursive;
            background: linear-gradient(180deg, #ff0033 0%, #990000 100%);
            color: #ffffff;
            text-shadow: 1px 1px 0 #000;
            border: 4px solid #ffaa00;
            box-shadow: 
                0 8px 0 #660000,
                0 10px 20px rgba(0, 0, 0, 0.5);
            padding: clamp(12px, 2.5vw, 18px) clamp(25px, 5vw, 45px);
            font-size: clamp(0.7em, 2vw, 1em);
            border-radius: 0;
            cursor: pointer;
            transition: all 0.1s;
            margin: clamp(10px, 2vh, 20px) clamp(5px, 1vw, 10px);
            touch-action: manipulation;
            position: relative;
            letter-spacing: 1px;
        }

        .btn:hover,
        .btn:active {
            transform: translateY(4px);
            box-shadow: 
                0 4px 0 #660000,
                0 6px 15px rgba(0, 0, 0, 0.5);
        }

        .btn:active {
            transform: translateY(8px);
            box-shadow: 
                0 0 0 #660000,
                0 2px 10px rgba(0, 0, 0, 0.5);
        }

        /* Music player - RETRO */
        .music-player {
            position: fixed;
            bottom: clamp(15px, 3vh, 25px);
            right: clamp(15px, 3vw, 25px);
            background: #1a0a0a;
            border: 3px solid #ff0033;
            box-shadow: 0 0 20px rgba(255, 0, 51, 0.5);
            padding: clamp(8px, 1.5vw, 12px) clamp(12px, 2.5vw, 18px);
            display: flex;
            align-items: center;
            gap: clamp(8px, 2vw, 12px);
            z-index: 1000;
        }

        .music-btn {
            font-family: 'Press Start 2P', cursive;
            background: #ff0033;
            color: #ffffff;
            border: 2px solid #ffaa00;
            width: clamp(32px, 5vw, 40px);
            height: clamp(32px, 5vw, 40px);
            cursor: pointer;
            font-size: clamp(10px, 2vw, 12px);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s;
            flex-shrink: 0;
        }

        .music-btn:hover,
        .music-btn:active {
            background: #ffaa00;
            color: #000;
        }

        .track-info {
            font-family: 'VT323', monospace;
            font-size: clamp(10px, 1.8vw, 13px);
            color: #ffaa00;
            text-shadow: 1px 1px 0 #995500;
            max-width: clamp(80px, 15vw, 120px);
            display: none;
            letter-spacing: 1px;
        }

        /* RETRO Counter */
        .counter {
            font-family: 'Press Start 2P', cursive;
            font-size: clamp(2.5em, 8vw, 4.5em);
            color: #ff0033;
            text-shadow: 
                4px 4px 0 #990000,
                8px 8px 0 #660000,
                0 0 30px #ff0033;
            animation: counterBlink 1s steps(2) infinite;
            letter-spacing: 4px;
        }

        @keyframes counterBlink {
            0%, 70% { opacity: 1; }
            71%, 100% { opacity: 0.7; }
        }

        /* RETRO Big heart */
        .heart-big {
            font-size: clamp(6em, 18vw, 12em);
            animation: heartBeat 1s steps(4) infinite;
            filter: drop-shadow(0 0 30px rgba(255, 0, 51, 0.8));
        }

        @keyframes heartBeat {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        /* Desktop specific */
        @media (min-width: 769px) {
            .track-info {
                display: block;
            }
        }
    </style>
</head>
<body>
    <div class="gradient-bg"></div>
    
    <div class="music-player">
        <button class="music-btn" id="musicBtn">‚ñ∂</button>
        <div class="track-info">
            <div style="font-weight: bold;">TOTORO</div>
            <div>THEME</div>
        </div>
    </div>

    <audio id="music" loop>
        <source src="https://cdn.jsdelivr.net/gh/napthedev/file-share@master/totoro.mp3" type="audio/mpeg">
    </audio>

    <div id="polaroidContainer"></div>

    <div class="page active" id="page0">
        <div class="totoro">     ‚àßÔºø‚àß
   ÔºàÔΩ°ÔΩ•œâÔΩ•ÔΩ°)„Å§‚îÅ‚òÜ„Éª*„ÄÇ
   ‚äÇ„ÄÄ„ÄÄ „Éé „ÄÄ„ÄÄ„ÄÄ„Éª„Çú+.
    „Åó„ÉºÔº™„ÄÄ„ÄÄ„ÄÄ¬∞„ÄÇ+ *¬¥¬®)</div>
        <h1 class="title">FOR RISA</h1>
        <p class="subtitle">A VALENTINE'S ADVENTURE</p>
        <div class="tap-anywhere" onclick="nextPage()">‚ñ∂ TAP TO BEGIN ‚óÄ</div>
    </div>

    <div class="page" id="page1">
        <h1 class="title">MY LOVE</h1>
        <p class="text">Like Totoro watching over the forest, I watch over you with endless devotion.</p>
        <p class="text">You are the lily in my garden, the most beautiful bloom.</p>
        <div class="tap-anywhere" onclick="nextPage()">‚ñ∂ CONTINUE ‚óÄ</div>
    </div>

    <div class="page" id="page2">
        <h1 class="title">5 REASONS</h1>
        <p class="subtitle">CLICK EACH LILY</p>
        <div class="lily-container">
            <div class="lily" onclick="clickLily(1, event)">üå∫</div>
            <div class="lily" onclick="clickLily(2, event)">üå∫</div>
            <div class="lily" onclick="clickLily(3, event)">üå∫</div>
            <div class="lily" onclick="clickLily(4, event)">üå∫</div>
            <div class="lily" onclick="clickLily(5, event)">üå∫</div>
        </div>
        <div id="currentMessage"></div>
        <div id="lilyCounter" style="font-family: 'Press Start 2P'; font-size: clamp(0.8em, 2vw, 1em); color: #ffaa00; text-align: center; margin: 20px 0; text-shadow: 2px 2px 0 #995500;">LILIES CLICKED: <span id="lilyCount">0</span>/5</div>
        <button class="btn" id="continueBtn" style="display: none;" onclick="nextPage()">CONTINUE</button>
    </div>

    <div class="page" id="page3">
        <h1 class="title">GHIBLI STORY</h1>
        <p class="text">TOTORO: You appeared like magic</p>
        <p class="text">HOWL: My heart is yours</p>
        <p class="text">SPIRITED: You enchanted my soul</p>
        <div class="tap-anywhere" onclick="nextPage()">‚ñ∂ CONTINUE ‚óÄ</div>
    </div>

    <div class="page" id="page4">
        <h1 class="title">FUTURE DOCTOR</h1>
        <p class="text">Your dedication to medicine fills me with pride.</p>
        <p class="japanese">È†ëÂºµ„Å£„Å¶„Çã„ÅÇ„Å™„Åü„ÅåÂ§ßÂ•Ω„ÅçÔºÅ</p>
        <p class="subtitle">I LOVE YOUR HARD WORK!</p>
        <div class="tap-anywhere" onclick="nextPage()">‚ñ∂ CONTINUE ‚óÄ</div>
    </div>

    <div class="page" id="page5">
        <h1 class="title">INFINITE</h1>
        <div class="counter" id="counter">‚àû</div>
        <p class="text">Infinite reasons I love you</p>
        <p class="japanese">„Åö„Å£„Å®„Åö„Å£„Å®ÊÑõ„Åó„Å¶„Çã</p>
        <p class="subtitle">FOREVER & EVER</p>
        <div class="tap-anywhere" onclick="nextPage()">‚ñ∂ CONTINUE ‚óÄ</div>
    </div>

    <div class="page" id="page6">
        <div class="heart-big">üíù</div>
        <h1 class="title">BE MY VALENTINE?</h1>
        <div style="display: flex; gap: clamp(10px, 2vw, 20px); margin-top: clamp(20px, 4vh, 40px); flex-wrap: wrap; justify-content: center;">
            <button class="btn" id="yesBtn" onclick="handleYes()">YES!</button>
            <button class="btn" id="noBtn" onclick="handleNo()" style="background: linear-gradient(180deg, #666 0%, #333 100%);">NO</button>
        </div>
    </div>

    <div class="page" id="page7">
        <div class="heart-big">üíï</div>
        <h1 class="title">I KNEW IT!</h1>
        <p class="japanese">ÊÑõ„Åó„Å¶„Çã</p>
        <p class="subtitle">I LOVE YOU</p>
        <p class="text" style="margin-top: clamp(20px, 4vh, 40px);">HAPPY VALENTINE'S DAY</p>
        <p class="text">FOREVER YOURS</p>
    </div>

    <script>
        let currentPage = 0;
        const totalPages = 8;
        let musicPlaying = false;
        let liliesClicked = 0;
        let clickedLilies = new Set();
        let noClickCount = 0;

        const lilyMessages = {
            1: { title: "COMPASSION", msg: "Risa, the way you care for others makes you perfect for medicine.", jp: "ÂÑ™„Åó„Åï„ÅåÊ∫¢„Çå„Å¶„Çã" },
            2: { title: "STRENGTH", msg: "Medical school is tough, but you're tougher. You inspire me.", jp: "„ÅÇ„Å™„Åü„ÅØÊú¨ÂΩì„Å´Âº∑„ÅÑ" },
            3: { title: "YOUR SMILE", msg: "Your smile is my favorite sight in the world. Not kidding.", jp: "Á¨ëÈ°î„Åå‰∏ÄÁï™Â•Ω„Åç" },
            4: { title: "YOUR DREAMS", msg: "Watching you chase your dreams - I am so proud of you.", jp: "Â§¢„ÇíËøΩ„ÅÜÂßø„ÅåÁ¥†Êïµ" },
            5: { title: "SIMPLY YOU", msg: "Every little thing about you. You're perfect as you are.", jp: "ÂÖ®ÈÉ®„ÅåÂ§ßÂ•Ω„Åç" }
        };

        const pagePhotos = {
            0: [
                { src: 'images/photo1.jpeg', caption: 'Forever', rotation: -8, top: '12%', left: '5%' },
                { src: 'images/photo2.jpeg', caption: 'My Love', rotation: 6, top: '15%', right: '8%' },
                { src: 'images/photo3.jpeg', caption: 'Together', rotation: -5, bottom: '20%', left: '10%' }
            ],
            1: [
                { src: 'images/photo4.jpeg', caption: 'Best Day', rotation: 10, top: '50%', right: '5%' },
                { src: 'images/photo5.jpeg', caption: 'You & Me', rotation: -10, bottom: '15%', right: '12%' },
                { src: 'images/photo6.jpeg', caption: 'Always', rotation: 7, top: '18%', left: '8%' }
            ],
            2: [
                { src: 'images/photo7.jpeg', caption: 'Our Story', rotation: -6, top: '12%', right: '10%' },
                { src: 'images/photo8.jpeg', caption: 'Beautiful', rotation: 8, bottom: '25%', left: '7%' },
                { src: 'images/photo1.jpeg', caption: 'Memories', rotation: -9, top: '45%', right: '6%' }
            ],
            3: [
                { src: 'images/photo9.jpeg', caption: 'Adventure', rotation: 5, top: '15%', left: '6%' },
                { src: 'images/photo10.png', caption: 'Forever Yours', rotation: -7, bottom: '20%', right: '9%' },
                { src: 'images/photo2.jpeg', caption: 'My Heart', rotation: 9, top: '50%', left: '8%' }
            ],
            4: [
                { src: 'images/photo3.jpeg', caption: 'Love You', rotation: -8, top: '10%', right: '7%' },
                { src: 'images/photo4.jpeg', caption: 'Love you', rotation: 6, bottom: '18%', left: '10%' },
                { src: 'images/photo5.jpeg', caption: 'Yes, you', rotation: -5, top: '48%', right: '8%' }
            ],
            5: [
                { src: 'images/photo8.jpeg', caption: 'Perfect', rotation: 7, top: '14%', left: '9%' },
                { src: 'images/photo7.jpeg', caption: 'My World', rotation: -9, bottom: '22%', right: '11%' },
                { src: 'images/photo2.jpeg', caption: 'You are', rotation: 8, top: '52%', left: '7%' }
            ],
            6: [
                { src: 'images/photo9.jpeg', caption: 'Say Yes', rotation: -6, top: '16%', right: '10%' },
                { src: 'images/photo5.jpeg', caption: 'Be Mine', rotation: 5, bottom: '20%', left: '8%' },
                { src: 'images/photo1.jpeg', caption: 'Valentine', rotation: -8, top: '50%', right: '7%' }
            ],
            7: [
                { src: 'images/photo2.jpeg', caption: 'I Love You', rotation: 9, top: '12%', left: '6%' },
                { src: 'images/photo3.jpeg', caption: 'Forever', rotation: -7, bottom: '18%', right: '12%' },
                { src: 'images/photo4.jpeg', caption: 'Always', rotation: 6, top: '48%', left: '10%' }
            ]
        };

        window.addEventListener('load', () => {
            createRosePetals();
            createParticles();
            updatePolaroids();
        });

        function createRosePetals() {
            const petalCount = window.innerWidth < 768 ? 20 : 35;
            for (let i = 0; i < petalCount; i++) {
                createSinglePetal();
            }
        }

        function createSinglePetal() {
            const petal = document.createElement('div');
            petal.className = Math.random() > 0.5 ? 'rose-petal spinning' : 'rose-petal';
            petal.style.left = Math.random() * 100 + '%';
            petal.style.width = (12 + Math.random() * 8) + 'px';
            petal.style.height = (12 + Math.random() * 8) + 'px';
            petal.style.setProperty('--drift', (Math.random() * 200 - 100) + 'px');
            petal.style.setProperty('--rotation', (Math.random() * 720 + 360) + 'deg');
            petal.style.animationDuration = (Math.random() * 8 + 8) + 's';
            petal.style.animationDelay = Math.random() * 5 + 's';
            
            petal.addEventListener('click', function(e) {
                e.stopPropagation();
                spawnMorePetals(e.clientX || e.pageX, e.clientY || e.pageY);
                this.style.animation = 'none';
                this.style.transform = 'scale(2) rotate(360deg)';
                this.style.opacity = '0';
                setTimeout(() => this.remove(), 300);
            });
            
            document.body.appendChild(petal);
            
            const duration = parseFloat(petal.style.animationDuration) * 1000;
            setTimeout(() => {
                if (petal.parentNode) petal.remove();
            }, duration + 5000);
        }

        function spawnMorePetals(x, y) {
            for (let i = 0; i < 5; i++) {
                setTimeout(() => {
                    const petal = document.createElement('div');
                    petal.className = Math.random() > 0.5 ? 'rose-petal spinning' : 'rose-petal';
                    petal.style.left = x + 'px';
                    petal.style.top = y + 'px';
                    petal.style.width = (12 + Math.random() * 8) + 'px';
                    petal.style.height = (12 + Math.random() * 8) + 'px';
                    
                    const angle = (i / 5) * Math.PI * 2;
                    const burstDistance = 50 + Math.random() * 50;
                    const burstX = Math.cos(angle) * burstDistance;
                    const burstY = Math.sin(angle) * burstDistance;
                    
                    petal.style.setProperty('--drift', burstX + 'px');
                    petal.style.setProperty('--rotation', (Math.random() * 720 + 360) + 'deg');
                    petal.style.animationDuration = (Math.random() * 6 + 6) + 's';
                    petal.style.animationDelay = '0s';
                    
                    petal.addEventListener('click', function(e) {
                        e.stopPropagation();
                        spawnMorePetals(e.clientX || e.pageX, e.clientY || e.pageY);
                        this.style.animation = 'none';
                        this.style.transform = 'scale(2) rotate(360deg)';
                        this.style.opacity = '0';
                        setTimeout(() => this.remove(), 300);
                    });
                    
                    document.body.appendChild(petal);
                    
                    const duration = parseFloat(petal.style.animationDuration) * 1000;
                    setTimeout(() => {
                        if (petal.parentNode) petal.remove();
                    }, duration + 5000);
                }, i * 50);
            }
        }

        function createParticles() {
            const particleCount = window.innerWidth < 768 ? 15 : 25;
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDuration = (Math.random() * 8 + 6) + 's';
                particle.style.animationDelay = Math.random() * 5 + 's';
                document.body.appendChild(particle);
            }
        }

        function updatePolaroids() {
            const container = document.getElementById('polaroidContainer');
            container.innerHTML = '';
            
            const photos = pagePhotos[currentPage] || [];
            photos.forEach((photo, index) => {
                setTimeout(() => {
                    const polaroid = document.createElement('div');
                    polaroid.className = 'polaroid';
                    polaroid.setAttribute('data-caption', photo.caption);
                    polaroid.style.setProperty('--rotation', photo.rotation + 'deg');
                    
                    if (photo.top) polaroid.style.top = photo.top;
                    if (photo.bottom) polaroid.style.bottom = photo.bottom;
                    if (photo.left) polaroid.style.left = photo.left;
                    if (photo.right) polaroid.style.right = photo.right;
                    
                    polaroid.innerHTML = `<img src="${photo.src}" alt="${photo.caption}">`;
                    container.appendChild(polaroid);
                    
                    setTimeout(() => polaroid.classList.add('visible'), 100);
                }, index * 250);
            });
        }

        function nextPage() {
            if (currentPage === 0) startMusic();

            const current = document.getElementById('page' + currentPage);
            current.classList.add('exiting');
            
            setTimeout(() => {
                current.classList.remove('active', 'exiting');
                currentPage++;
                const next = document.getElementById('page' + currentPage);
                next.classList.add('active');
                updatePolaroids();

                if (currentPage === 5) animateCounter();
            }, 400);
        }

        function clickLily(num, event) {
            event.stopPropagation();
            const lily = event.target;
            if (lily.classList.contains('clicked')) return;
            
            lily.classList.add('clicked');
            clickedLilies.add(num);
            
            const msg = lilyMessages[num];
            const container = document.getElementById('currentMessage');
            container.innerHTML = '';
            
            const reveal = document.createElement('div');
            reveal.className = 'message-reveal';
            reveal.innerHTML = `
                <h3>${msg.title}</h3>
                <p class="text" style="font-size: clamp(1em, 2.5vw, 1.3em);">${msg.msg}</p>
                <p class="japanese" style="font-size: clamp(1.4em, 3.5vw, 1.8em);">${msg.jp}</p>
            `;
            container.appendChild(reveal);
            
            // Update counter
            document.getElementById('lilyCount').textContent = clickedLilies.size;
            
            if (clickedLilies.size === 5) {
                setTimeout(() => {
                    document.getElementById('continueBtn').style.display = 'block';
                }, 500);
            }
        }

        function animateCounter() {
            let count = 0;
            const counter = document.getElementById('counter');
            const interval = setInterval(() => {
                count += 173;
                counter.textContent = count.toLocaleString();
                if (count >= 1000000) {
                    clearInterval(interval);
                    setTimeout(() => counter.textContent = '‚àû', 300);
                }
            }, 25);
        }

        function handleNo() {
            const noBtn = document.getElementById('noBtn');
            const yesBtn = document.getElementById('yesBtn');
            noClickCount++;
            
            if (noClickCount === 1) {
                noBtn.textContent = 'SURE?';
            } else if (noClickCount === 2) {
                noBtn.textContent = 'REALLY?';
                yesBtn.style.transform = 'scale(1.2)';
            } else if (noClickCount === 3) {
                noBtn.textContent = 'PLEASE?';
                yesBtn.style.transform = 'scale(1.4)';
            } else {
                const randomX = Math.random() * (window.innerWidth - 150);
                const randomY = Math.random() * (window.innerHeight - 80);
                noBtn.style.position = 'fixed';
                noBtn.style.left = randomX + 'px';
                noBtn.style.top = randomY + 'px';
                noBtn.textContent = ':(';
                yesBtn.style.transform = 'scale(1.6)';
            }
        }

        function handleYes() {
            setTimeout(() => nextPage(), 500);
        }

        function startMusic() {
            const music = document.getElementById('music');
            music.volume = 0.4;
            music.play().then(() => {
                musicPlaying = true;
                document.getElementById('musicBtn').textContent = '‚ùö‚ùö';
            }).catch(e => console.log('Music autoplay prevented'));
        }

        document.getElementById('musicBtn').addEventListener('click', () => {
            const music = document.getElementById('music');
            if (musicPlaying) {
                music.pause();
                document.getElementById('musicBtn').textContent = '‚ñ∂';
                musicPlaying = false;
            } else {
                music.volume = 0.4;
                music.play();
                document.getElementById('musicBtn').textContent = '‚ùö‚ùö';
                musicPlaying = true;
            }
        });
    </script>
</body>
</html>
